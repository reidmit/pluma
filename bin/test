#!/bin/bash

source $(dirname $0)/env

usage() {
  echo "usage: $0 [-p|--package PACKAGE] [-t|--test TEST_PATTERN]"
}

test_name_filter=
package_name_filter=

while [ "$1" != "" ]; do
  case $1 in
    -p | --package ) shift; package_name_filter="-p $1"; ;;
    -t | --test ) shift; test_name_filter="$1"; ;;
    * ) usage; exit 1
  esac

  shift
done

cargo test \
  --quiet \
  --no-fail-fast \
  $package_name_filter \
  "$test_name_filter"